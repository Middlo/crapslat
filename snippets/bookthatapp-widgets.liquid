{%- comment -%}
BookThatApp Widgets Bootstrap Loader

This file is automatically generated. Do not modify. Any modifications will be overwritten.

Contact support@zetya.com if you need assistance.

== Version: 1.3 ==
{%- endcomment -%}

{% if content_for_header contains 'bta-installed.js' %}

  <script>
    var productConfig = {};
    {% if product.metafields.bookthatapp.config_json %}
    var productMetafields = '{{ product.metafields.bookthatapp.config_json | json }}';
    if (productMetafields != '') {
      productConfig = JSON.parse(productMetafields);
    }
    {% else %}
    // legacy metafields
    var productMetafields = '{{ product.metafields.bookthatapp.config }}';
    if (productMetafields != '') {
      productConfig = JSON.parse('{"' + decodeURI(productMetafields).replace(/"/g, '\\"').replace(/&/g, '","').replace(/=/g,'":"') + '"}');
    }
    {% endif %}
    window.BtaConfig = {
      account: '{{ shop.permanent_domain | split: '.' | first }}',
      settings: JSON.parse('{{ shop.metafields.bookthatapp.config }}' || '{}'),
      {% if product %} 'product': productConfig,{% endif %}
      cart: {{ cart | json }},
      version: '1.3'
    }
  </script>

  {{ 'bta-widgets-bootstrap.min.js' | asset_url  | script_tag }}

{%- endif -%}
